# Configuration for NSGF++ on MNIST dataset

seed: 42

model:
  in_channels: 1  # MNIST is grayscale
  out_channels: 1
  base_channels: 32
  depth: 1
  time_emb_dim: 16
  attention_heads: 1  # not used currently

training:
  # Batch sizes for each component
  batch_size_velocity: 256
  batch_size_time: 256
  batch_size_nsf: 256

  # Learning rates
  lr_velocity: 1e-4
  lr_time_predictor: 1e-4
  lr_nsf: 1e-4

  betas: [0.9, 0.999]
  weight_decay: 0.0

  total_iters_velocity: 20000
  total_iters_time: 40000
  total_iters_nsf: 20000

  # Sinkhorn parameters (chosen for MNIST)
  blur: 0.5
  scaling: 0.80

  # Euler integration steps
  eta_nsfg: 0.2
  T_max: 5  # NSGF phase steps (â‰¤5)
  num_pool_batches: 1500

  # NSF refinement parameters
  omega_nsf: 0.02

logging:
  log_dir: logs/nsfgpp_mnist
  checkpoint_dir: checkpoints/nsfgpp_mnist
